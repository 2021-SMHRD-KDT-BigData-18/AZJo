<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="main/java/dao/BoardDAO">

	<insert id="write" parameterType="main.java.entity.Board">
		insert into T_project
		values(prj_seq.nextval,#{t_id},#{prj_category},#{prj_name},#{post},'모집중',#{deadline_dt},#{start_dt},#{end_dt},#{recruit_count},null,null,sysdate,null)
	</insert>

	<select id="list" resultType="main.java.entity.Board">
		SELECT t.*, TO_CHAR(t.post_dt, 'YYYY-MM-DD') AS format_post_dt
		FROM T_project t
		ORDER BY t.post_dt DESC
	</select>

	<select id="searchPost" resultType="main.java.entity.Board"
		parameterType="main.java.entity.Board">
		SELECT *
		FROM T_PROJECT
		WHERE prj_category = #{prj_category}
		<choose>
			<when test="prj_name != null and !prj_name.equals('')">
				AND prj_name LIKE '%' || #{prj_name} || '%'
			</when>
		</choose>
	</select>

	<select id="viewPostContent" resultType="main.java.entity.Board"
		parameterType="main.java.entity.Board">
		select *
		from T_PROJECT
		where prj_seq = #{prj_seq}
	</select>



	<update id="updatePost" parameterType="main.java.entity.Board">
		update t_project
		set
		prj_category = #{prj_category},
		prj_name = #{prj_name},
		status = #{status},
		deadline_dt = #{deadline_dt},
		start_dt = #{start_dt},
		end_dt = #{end_dt},
		recruit_count = #{recruit_count},
		post = #{post}
		where prj_seq = #{prj_seq}
	</update>

	<delete id="deletePost" parameterType="main.java.entity.Board">
		delete from t_project
		where prj_seq=#{prj_seq}
	</delete>

	<select id="getBoardCount" resultType="java.lang.Integer">
		SELECT count(*) FROM
		T_project
	</select>

	<select id="ListPage" resultType="main.java.entity.Board"
		parameterType="main.java.entity.Board">
		SELECT *
		FROM (
		SELECT rownum AS rn, p.*
		FROM (
		SELECT *
		FROM t_project
		ORDER BY post_dt DESC
		) p
		) sub
		WHERE sub.rn >= (${prj_seq}
		- 1) * 10 + 1
		AND sub.rn &lt;= ${prj_seq} * 10
		ORDER BY sub.rn
	</select>


</mapper>